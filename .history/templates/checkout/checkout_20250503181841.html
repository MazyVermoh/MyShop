{% extends "store/base.html" %}
{% load static %}

{% block title %}ะัะพัะผะปะตะฝะธะต ะทะฐะบะฐะทะฐ โยABUZADAยSTORE{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'store/styles/checkout.css' %}">
{% endblock %}

{% block content %}
<section class="checkout-container">
  <h2 class="checkout-heading">ะัะพัะผะปะตะฝะธะต ะทะฐะบะฐะทะฐ</h2>

  <div class="checkout-grid">
    {# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
       ะะะะะฏ ะะะะะะะ  โ  ะคะะะะ
       โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ #}
    <form method="post"
          action="{% url 'checkout:process' %}"
          class="checkout-form"
          autocomplete="off">
      {% csrf_token %}

      {# 1. ะะพะฝัะฐะบัั #} โฆย**(ะพััะฐะฒะปัะตะผ ะฑะตะท ะธะทะผะตะฝะตะฝะธะน)** โฆ

      {# 2. ะะดัะตั #}
      <div class="checkout-section">
        <h3 class="section-title">ะะดัะตั ะดะพััะฐะฒะบะธ</h3>

        <div class="field-group">
          <label for="id_country">ะกััะฐะฝะฐ</label>
          <select id="id_country" name="country">
            <option value="RU">ะะพััะธั</option>
            <option value="BY">ะะตะปะฐัััั</option>
            <option value="KZ">ะะฐะทะฐัััะฐะฝ</option>
          </select>
        </div>

        {# ๐  ะขะะะฌะะ ะะะะะยโ ะฐะฒัะพะฟะพะดัะบะฐะทะบะฐ DaData #}
        <div class="field-group">
          <label for="id_city">ะะพัะพะด *</label>
          <input id="id_city"
                 name="city"
                 required
                 placeholder="ะะฐัะฝะธัะต ะฒะฒะพะดะธััโฆ"
                 data-dadata="city">
        </div>

        {# ัะปะธัะฐ + ะดะพะผยโ ะบะฐะบ ะฑัะปะพ #}
        <div class="field-group">
          <label for="id_address">ะฃะปะธัะฐ, ะดะพะผ,ยะบะฒ. *</label>
          <input id="id_address" name="address" required>
        </div>

        {# ะกะบัััะพ: ััะดะฐ ะฟะพะปะพะถะธะผ ะธะฝะดะตะบั, ะบะพัะพััะน ะฒะตัะฝัั DaData #}
        <input type="hidden" id="hidden_postcode" name="postcode">
      </div>

      {# 3. ะกะฟะพัะพะฑ ะดะพััะฐะฒะบะธ, 4.ยะะฟะปะฐัะฐยโ ะฑะตะท ะธะทะผะตะฝะตะฝะธะนยโฆ #}

      โฆ
    </form>

    {# ะะะะะะฏ ะะะะะะะ (ัะตะทัะผะต)ยโ ะฑะตะท ะธะทะผะตะฝะตะฝะธะน #}
  </div>
</section>

{# โโโโโโโโโ  DaDataยSuggestions ยโโโโโโโโโ #}
<script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/suggestions-jquery@latest/dist/js/jquery.suggestions.min.js"></script>
<link  href="https://cdn.jsdelivr.net/npm/suggestions-jquery@latest/dist/css/suggestions.min.css" rel="stylesheet"/>

<script>
  $(function () {
    $("#id_city").suggestions({
      token:     "ะะะจ_DADATA_API_KEY",      // โ ะฒััะฐะฒััะต ัะตะฐะปัะฝัะน ะบะปัั
      type:      "ADDRESS",
      hint:      false,
      bounds:    "city",                    // ัะพะปัะบะพ ะณะพัะพะดะฐ/ะฝะฐั.ะฟัะฝะบัั
      autoSelectFirst: true,
      onSelect:  function (s) {
        // ะัะธ ะฒัะฑะพัะต ะบะปะฐะดัะผ ะธะฝะดะตะบั ะฒยัะบัััะพะต ะฟะพะปะต,
        // ะฐ ะณะพัะพะด ะฟะธัะตะผ ะฝะพัะผะฐะปะธะทะพะฒะฐะฝะฝัะผ
        $("#id_city").val(s.data.city_with_type);
        $("#hidden_postcode").val(s.data.postal_code);
      }
    });
  });
</script>
{% endblock %}